(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"+L6D":function(e,t,n){"use strict";n.r(t);var r=n("o0o1"),a=n.n(r),i=n("JRvM"),o=n("L2JU");function s(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){s(i,r,a,o,c,"next",e)}function c(e){s(i,r,a,o,c,"throw",e)}o(void 0)}))}}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l={name:"CategoryProducts",data:function(){return{headers:[{sortable:!1,text:"ID",value:"id"},{sortable:!0,text:"Name",value:"name"},{sortable:!1,text:"Param",value:"param",align:"right"},{sortable:!1,text:"Publish",value:"publish",align:"right"},{sortable:!1,text:"Updated at",value:"updated_at",align:"right"},{text:"Actions",value:"actions",sortable:!1,align:"right"}],fields:[{ref:"name",title:"Name",val:"",rules:[],required:!0,type:"text"},{ref:"description",title:"Description",val:"",rules:[],required:!0,type:"text"},{ref:"param",title:"Param",val:"",rules:[],required:!0,type:"text"},{ref:"meta_description",title:"Meta description",val:"",rules:[],required:!1,type:"text"},{ref:"meta_keywords",title:"Meta keywords",val:"",rules:[],required:!1,type:"text"},{ref:"meta_title",title:"Meta title",val:"",rules:[],required:!1,type:"text"},{ref:"publish",title:"Publish",val:!1,rules:[],required:!1,type:"switch"},{ref:"id",title:"id",val:"",rules:[],required:!1,type:"hidden"}],openDialog:!1,editIndex:-1,maxDate:null,sheet:{opentSheet:!1,message:""}}},watch:{},methods:p(p({},Object(o.b)({setCategories:"SET_CATEGORIES"})),{},{editItem:function(e){this.openDialog=!0,this.editIndex=this.categories.products.findIndex((function(t){return t.name==e.name})),this.fields.forEach((function(t){t.val=e[t.ref]}))},deleteItem:function(e){var t=this;return c(a.a.mark((function n(){var r;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.categories.products.findIndex((function(t){return t.name==e.name}));case 2:if(!((r=n.sent)>-1)){n.next=6;break}return n.next=6,i.a.destroy(e.id).then((function(e){var n=e.data.message;t.categories.products.splice(r,1),t.sheet.opentSheet=!0,t.sheet.message=n}));case 6:case"end":return n.stop()}}),n)})))()},onSave:function(e){var t=this;return c(a.a.mark((function n(){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t.editIndex>-1)){n.next=5;break}return n.next=3,i.a.update(e).then((function(e){var n=e.data.data;Object.assign(t.categories.products[t.editIndex],n),t.$store.commit("SET_CATEGORIES",p(p({},t.categories),{},{products:t.categories.products}))}));case 3:n.next=7;break;case 5:return n.next=7,i.a.create(e).then((function(e){var n=e.data.data;t.categories.products.push(n)}));case 7:t.openDialog=!1,t.editIndex=-1;case 9:case"end":return n.stop()}}),n)})))()},getMaxDate:function(){var e=this.categories.products.reduce((function(e,t){return new Date(e.created_at)>new Date(t.created_at)?e:t}));this.maxDate=new Date(e.created_at).toDateString()}}),computed:p(p({},Object(o.c)(["categories"])),{},{formTitle:function(){return-1===this.editIndex?"New Item":"Edit Item"}}),mounted:function(){var e=this;return c(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.categories.products){t.next=6;break}return t.next=3,i.a.index();case 3:n=t.sent,r=n.data,e.setCategories(p(p({},e.categories),{},{products:r.data}));case 6:e.getMaxDate();case 7:case"end":return t.stop()}}),t)})))()}},f=n("KHd+"),v=Object(f.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("base-material-card",{staticClass:"px-5 py-10",attrs:{color:"warning"},scopedSlots:e._u([{key:"heading",fn:function(){return[n("div",{staticClass:"display-2 font-weight-light"},[e._v("Danh mục Sản phẩm")]),e._v(" "),n("div",{staticClass:"subtitle-1 font-weight-light"},[e._v("Danh mục mới nhất vào ngày "+e._s(e.maxDate))]),e._v(" "),n("v-spacer",{staticClass:"py-3"}),e._v(" "),n("base-dialogs-form-input",{attrs:{formTitle:e.formTitle,fields:e.fields,openDialog:e.openDialog,editIndex:e.editIndex},on:{"update:fields":function(t){e.fields=t},"update:openDialog":function(t){e.openDialog=t},"update:open-dialog":function(t){e.openDialog=t},"update:editIndex":function(t){e.editIndex=t},"update:edit-index":function(t){e.editIndex=t},save:e.onSave}})]},proxy:!0}])},[e._v(" "),n("v-card-text",[n("v-data-table",{attrs:{headers:e.headers,items:e.categories.products},scopedSlots:e._u([{key:"item.updated_at",fn:function(t){var n=t.item;return[e._v(e._s(new Date(n.updated_at).toLocaleString()))]}},{key:"item.publish",fn:function(t){var n=t.item;return[e._v(e._s(1==n.publish))]}},{key:"item.actions",fn:function(t){var r=t.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(r)}}},[e._v("fal fa-pencil")]),e._v(" "),n("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(r)}}},[e._v("fal fa-trash-alt")])]}}])})],1)],1),e._v(" "),n("base-bottom-sheet",{attrs:{opentSheet:e.sheet.opentSheet,message:e.sheet.message},on:{"update:opentSheet":function(t){return e.$set(e.sheet,"opentSheet",t)},"update:opent-sheet":function(t){return e.$set(e.sheet,"opentSheet",t)}}})],1)}),[],!1,null,null,null);t.default=v.exports},Fgb4:function(e,t,n){"use strict";var r=n("vDqi"),a=n.n(r),i={DOMAIN_API:"https://127.0.0.2"},o=document.head.querySelector('meta[name="x-token"]');t.a=a.a.create({baseURL:"".concat(i.DOMAIN_API,"/api"),headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(o.content)}})},JRvM:function(e,t,n){"use strict";var r=n("o0o1"),a=n.n(r),i=n("Fgb4");function o(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function s(e){o(i,r,a,s,c,"next",e)}function c(e){o(i,r,a,s,c,"throw",e)}s(void 0)}))}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,o,u,p,d;return t=e,(n=[{key:"index",value:(d=s(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.a.get("category_products");case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),500===e.t0.response.status&&_vm.$router.push({name:"Logout"});case 10:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(){return d.apply(this,arguments)})},{key:"show",value:function(e){}},{key:"create",value:(p=s(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.post("category_products",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"update",value:(u=s(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,i.a.put("category_products/"+t.id,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"destroy",value:(o=s(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.delete("category_products/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})}])&&c(t.prototype,n),r&&c(t,r),e}();t.a=new u}}]);
//# sourceMappingURL=11.js.map