(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"7yMG":function(e,t,n){"use strict";n.r(t);var a=n("o0o1"),r=n.n(a),i=n("L2JU"),o=n("fAvd");n("J1HN");function s(e,t,n,a,r,i,o){try{var s=e[i](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(a,r)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var i=e.apply(t,n);function o(e){s(i,a,r,o,u,"next",e)}function u(e){s(i,a,r,o,u,"throw",e)}o(void 0)}))}}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={name:"Block",data:function(){return{headers:[{sortable:!1,text:"ID",value:"id"},{sortable:!1,text:"Name",value:"name"},{sortable:!1,text:"Publish",value:"publish",align:"right"},{sortable:!1,text:"Created at",value:"created_at",align:"center"},{sortable:!1,text:"Updated at",value:"updated_at",align:"right"},{text:"Actions",value:"actions",sortable:!1,align:"right"}],fieldsLeft:[{icon:"fal fa-pen",title:"Contents",active:!0,items:[{title:"id",ref:"id",rules:[],required:!0,value:""},{title:"Name",ref:"name",rules:[],required:!0,value:""},{title:"Content",isEditor:!0,ref:"content",value:""}]}],publish:!0,items:[],isLoading:!0,openDialog:!1,editIndex:-1,newItem:{},sheet:{opentSheet:!1,message:""}}},computed:l(l({},Object(i.c)(["blocks"])),{},{heading:function(){return-1===this.editIndex?"New Block":"Edit Block"}}),methods:l(l({},Object(i.b)({setBlocks:"SET_BLOCKS"})),{},{editItem:function(e){this.openDialog=!0,this.editIndex=this.items.findIndex((function(t){return t.name==e.name})),this.fieldsLeft.forEach((function(t){t.items.forEach((function(t){t.value=e[t.ref]}))})),console.log(e),this.publish=1===e.publish},onSave:function(e){var t=this;return u(r.a.mark((function n(){return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t.editIndex>-1)){n.next=5;break}return n.next=3,o.a.update(e).then((function(e){var n=e.data.data;Object.assign(t.items[t.editIndex],n),t.setBlocks(t.items)}));case 3:n.next=7;break;case 5:return n.next=7,o.a.create(e).then((function(e){var n=e.data.data;t.items.unshift(n),t.setBlocks(t.items)}));case 7:t.openDialog=!1,t.editIndex=-1;case 9:case"end":return n.stop()}}),n)})))()},getMaxDate:function(){this.newItem=this.items.reduce((function(e,t){return new Date(e.created_at)>new Date(t.created_at)?e:t}))},deleteItem:function(e){var t=this;return u(r.a.mark((function n(){var a;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.items.findIndex((function(t){return t.name==e.name}));case 2:if(!((a=n.sent)>-1)){n.next=6;break}return n.next=6,o.a.destroy(e).then((function(e){var n=e.data.message;t.items.splice(a,1),t.sheet.opentSheet=!0,t.sheet.message=n,t.setBlocks(t.items)}));case 6:case"end":return n.stop()}}),n)})))()}}),mounted:function(){var e=this;return u(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.index().then((function(t){var n=t.data.data;e.items=n,e.isLoading=!1,e.setBlocks(n),console.log(e.blocks),n.length&&e.getMaxDate()})).catch((function(t){e.isLoading=!0,console.log(t)}));case 2:case"end":return t.stop()}}),t)})))()}},p=n("KHd+"),h=Object(p.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("base-material-card",{staticClass:"px-5 py-10",attrs:{color:"warning"},scopedSlots:e._u([{key:"heading",fn:function(){return[n("div",{staticClass:"display-2 font-weight-light"},[e._v(e._s(e.newItem.name))]),e._v(" "),n("div",{staticClass:"subtitle-1 font-weight-light"},[e._v("New Block on "+e._s(new Date(e.newItem.created_at).toDateString()))]),e._v(" "),n("v-spacer",{staticClass:"py-3"}),e._v(" "),n("base-dialogs-form",{attrs:{heading:e.heading,openDialog:e.openDialog,fieldsLeft:e.fieldsLeft,publish:e.publish,editIndex:e.editIndex},on:{"update:openDialog":function(t){e.openDialog=t},"update:open-dialog":function(t){e.openDialog=t},"update:publish":function(t){e.publish=t},"update:editIndex":function(t){e.editIndex=t},"update:edit-index":function(t){e.editIndex=t},save:e.onSave}})]},proxy:!0}])},[e._v(" "),n("v-card-text",[n("v-data-table",{attrs:{loading:e.isLoading,headers:e.headers,items:e.items},scopedSlots:e._u([{key:"item.updated_at",fn:function(t){var n=t.item;return[e._v(e._s(new Date(n.updated_at).toLocaleString()))]}},{key:"item.thumbnail",fn:function(e){var t=e.item;return[n("v-img",{staticClass:"m-auto",attrs:{src:"/assets/"+t.thumbnail.name,width:"100"}})]}},{key:"item.category",fn:function(t){var n=t.item;return[e._v(e._s(n.category?n.category.name:""))]}},{key:"item.publish",fn:function(t){var n=t.item;return[e._v(e._s(1==n.publish))]}},{key:"item.actions",fn:function(t){var a=t.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(a)}}},[e._v("fal fa-pencil")]),e._v(" "),n("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(a)}}},[e._v("fal fa-trash-alt")])]}}])})],1)],1),e._v(" "),n("base-bottom-sheet",{attrs:{opentSheet:e.sheet.opentSheet,message:e.sheet.message},on:{"update:opentSheet":function(t){return e.$set(e.sheet,"opentSheet",t)},"update:opent-sheet":function(t){return e.$set(e.sheet,"opentSheet",t)}}})],1)}),[],!1,null,null,null);t.default=h.exports},Fgb4:function(e,t,n){"use strict";var a=n("vDqi"),r=n.n(a),i={DOMAIN_API:"https://127.0.0.2"},o=document.head.querySelector('meta[name="x-token"]');t.a=r.a.create({baseURL:"".concat(i.DOMAIN_API,"/api"),headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(o.content)}})},J1HN:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(e){return new Promise((function(t){return setTimeout(t,e)}))}},fAvd:function(e,t,n){"use strict";var a=n("o0o1"),r=n.n(a),i=n("Fgb4");function o(e,t,n,a,r,i,o){try{var s=e[i](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(a,r)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var i=e.apply(t,n);function s(e){o(i,a,r,s,u,"next",e)}function u(e){o(i,a,r,s,u,"throw",e)}s(void 0)}))}}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a,o,c,l,f;return t=e,(n=[{key:"index",value:(f=s(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.a.get("/blocks");case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),500===e.t0.response.status&&_vm.$router.push({name:"Logout"});case 10:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(){return f.apply(this,arguments)})},{key:"show",value:function(e){}},{key:"create",value:(l=s(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.post("/blocks",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"update",value:(c=s(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={name:t.name,content:t.content,updated_at:t.updated_at},e.next=3,i.a.put("/blocks/"+t.id,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"destroy",value:(o=s(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.delete("/blocks/".concat(t.id));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})}])&&u(t.prototype,n),a&&u(t,a),e}();t.a=new c}}]);
//# sourceMappingURL=8.js.map