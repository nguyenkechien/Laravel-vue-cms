{"version":3,"sources":["webpack:///./resources/js/BE/pages/Blocks/index.vue?cc0c","webpack:///resources/js/BE/pages/Blocks/index.vue","webpack:///./resources/js/BE/pages/Blocks/index.vue?967c","webpack:///./resources/js/BE/pages/Blocks/index.vue","webpack:///./resources/js/BE/config.js","webpack:///./resources/js/BE/http/http-common.js","webpack:///./resources/js/functions/sleep.js","webpack:///./resources/js/BE/services/BlockService.js"],"names":["name","data","headers","fieldsLeft","publish","items","isLoading","openDialog","editIndex","newItem","sheet","opentSheet","message","computed","heading","this","methods","editItem","findIndex","forEach","group","field","value","item","ref","console","log","getMaxDate","reduce","component","_vm","_h","$createElement","_c","_self","staticClass","attrs","scopedSlots","_u","key","fn","_v","_s","Date","created_at","toDateString","on","$event","onSave","proxy","updated_at","toLocaleString","thumbnail","category","deleteItem","$set","config","DOMAIN_API","xToken","document","head","querySelector","Axios","create","baseURL","content","sleep","ms","Promise","resolve","setTimeout","BlockService","http","get","response","status","$router","push","block","post","put","id"],"mappings":"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","file":"8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',[_c('base-material-card',{staticClass:\"px-5 py-10\",attrs:{\"color\":\"warning\"},scopedSlots:_vm._u([{key:\"heading\",fn:function(){return [_c('div',{staticClass:\"display-2 font-weight-light\"},[_vm._v(_vm._s(_vm.newItem.name))]),_vm._v(\" \"),_c('div',{staticClass:\"subtitle-1 font-weight-light\"},[_vm._v(\"New Block on \"+_vm._s(new Date(_vm.newItem.created_at).toDateString()))]),_vm._v(\" \"),_c('v-spacer',{staticClass:\"py-3\"}),_vm._v(\" \"),_c('base-dialogs-form',{attrs:{\"heading\":_vm.heading,\"openDialog\":_vm.openDialog,\"fieldsLeft\":_vm.fieldsLeft,\"publish\":_vm.publish,\"editIndex\":_vm.editIndex},on:{\"update:openDialog\":function($event){_vm.openDialog=$event},\"update:open-dialog\":function($event){_vm.openDialog=$event},\"update:publish\":function($event){_vm.publish=$event},\"update:editIndex\":function($event){_vm.editIndex=$event},\"update:edit-index\":function($event){_vm.editIndex=$event},\"save\":_vm.onSave}})]},proxy:true}])},[_vm._v(\" \"),_c('v-card-text',[_c('v-data-table',{attrs:{\"loading\":_vm.isLoading,\"headers\":_vm.headers,\"items\":_vm.items},scopedSlots:_vm._u([{key:\"item.updated_at\",fn:function(ref){\nvar item = ref.item;\nreturn [_vm._v(_vm._s(new Date(item.updated_at).toLocaleString()))]}},{key:\"item.thumbnail\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('v-img',{staticClass:\"m-auto\",attrs:{\"src\":(\"/assets/\" + (item.thumbnail.name)),\"width\":\"100\"}})]}},{key:\"item.category\",fn:function(ref){\nvar item = ref.item;\nreturn [_vm._v(_vm._s(item.category ? item.category.name : ''))]}},{key:\"item.publish\",fn:function(ref){\nvar item = ref.item;\nreturn [_vm._v(_vm._s(item.publish == 1 ? true : false))]}},{key:\"item.actions\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('v-icon',{staticClass:\"mr-2\",attrs:{\"small\":\"\"},on:{\"click\":function($event){return _vm.editItem(item)}}},[_vm._v(\"fal fa-pencil\")]),_vm._v(\" \"),_c('v-icon',{attrs:{\"small\":\"\"},on:{\"click\":function($event){return _vm.deleteItem(item)}}},[_vm._v(\"fal fa-trash-alt\")])]}}])})],1)],1),_vm._v(\" \"),_c('base-bottom-sheet',{attrs:{\"opentSheet\":_vm.sheet.opentSheet,\"message\":_vm.sheet.message},on:{\"update:opentSheet\":function($event){return _vm.$set(_vm.sheet, \"opentSheet\", $event)},\"update:opent-sheet\":function($event){return _vm.$set(_vm.sheet, \"opentSheet\", $event)}}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-container>\r\n    <base-material-card color=\"warning\" class=\"px-5 py-10\">\r\n      <template v-slot:heading>\r\n        <div class=\"display-2 font-weight-light\">{{ newItem.name }}</div>\r\n\r\n        <div\r\n          class=\"subtitle-1 font-weight-light\"\r\n        >New Block on {{ new Date(newItem.created_at).toDateString() }}</div>\r\n        <v-spacer class=\"py-3\" />\r\n        <base-dialogs-form\r\n          :heading=\"heading\"\r\n          :openDialog.sync=\"openDialog\"\r\n          :fieldsLeft=\"fieldsLeft\"\r\n          :publish.sync=\"publish\"\r\n          :editIndex.sync=\"editIndex\"\r\n          @save=\"onSave\"\r\n        />\r\n      </template>\r\n      <v-card-text>\r\n        <v-data-table :loading=\"isLoading\" :headers=\"headers\" :items=\"items\">\r\n          <template\r\n            v-slot:item.updated_at=\"{ item }\"\r\n          >{{ new Date(item.updated_at).toLocaleString() }}</template>\r\n          <template v-slot:item.thumbnail=\"{item}\">\r\n            <v-img :src=\"`/assets/${item.thumbnail.name}`\" width=\"100\" class=\"m-auto\" />\r\n          </template>\r\n          <template v-slot:item.category=\"{item}\">{{ item.category ? item.category.name : ''}}</template>\r\n          <template v-slot:item.publish=\"{ item }\">{{ item.publish == 1 ? true : false}}</template>\r\n          <template v-slot:item.actions=\"{ item }\">\r\n            <v-icon small class=\"mr-2\" @click=\"editItem(item)\">fal fa-pencil</v-icon>\r\n            <v-icon small @click=\"deleteItem(item)\">fal fa-trash-alt</v-icon>\r\n          </template>\r\n        </v-data-table>\r\n      </v-card-text>\r\n    </base-material-card>\r\n    <base-bottom-sheet :opentSheet.sync=\"sheet.opentSheet\" :message=\"sheet.message\" />\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapMutations, Commit } from \"vuex\";\r\nimport BlockService from \"./../../services/BlockService\";\r\nimport { sleep } from \"@/js/functions/sleep\";\r\nexport default {\r\n  name: \"Block\",\r\n  data() {\r\n    return {\r\n      headers: [\r\n        {\r\n          sortable: false,\r\n          text: \"ID\",\r\n          value: \"id\"\r\n        },\r\n        {\r\n          sortable: false,\r\n          text: \"Name\",\r\n          value: \"name\"\r\n        },\r\n        {\r\n          sortable: false,\r\n          text: \"Publish\",\r\n          value: \"publish\",\r\n          align: \"right\"\r\n        },\r\n        {\r\n          sortable: false,\r\n          text: \"Created at\",\r\n          value: \"created_at\",\r\n          align: \"center\"\r\n        },\r\n        {\r\n          sortable: false,\r\n          text: \"Updated at\",\r\n          value: \"updated_at\",\r\n          align: \"right\"\r\n        },\r\n        {\r\n          text: \"Actions\",\r\n          value: \"actions\",\r\n          sortable: false,\r\n          align: \"right\"\r\n        }\r\n      ],\r\n      fieldsLeft: [\r\n        {\r\n          icon: \"fal fa-pen\",\r\n          title: \"Contents\",\r\n          active: true,\r\n          items: [\r\n            {\r\n              title: \"id\",\r\n              ref: \"id\",\r\n              rules: [],\r\n              required: true,\r\n              value: \"\"\r\n            },\r\n            {\r\n              title: \"Name\",\r\n              ref: \"name\",\r\n              rules: [],\r\n              required: true,\r\n              value: \"\"\r\n            },\r\n            {\r\n              title: \"Content\",\r\n              isEditor: true,\r\n              ref: \"content\",\r\n              value: \"\"\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      publish: true,\r\n      items: [],\r\n      isLoading: true,\r\n      openDialog: false,\r\n      editIndex: -1,\r\n      newItem: {},\r\n      sheet: {\r\n        opentSheet: false,\r\n        message: \"\"\r\n      }\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState([\"blocks\"]),\r\n    heading() {\r\n      return this.editIndex === -1 ? \"New Block\" : \"Edit Block\";\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapMutations({\r\n      setBlocks: \"SET_BLOCKS\"\r\n    }),\r\n    editItem(item) {\r\n      this.openDialog = true;\r\n      this.editIndex = this.items.findIndex(data => data.name == item.name);\r\n      this.fieldsLeft.forEach(group => {\r\n        group.items.forEach(field => {\r\n          field.value = item[field.ref];\r\n        });\r\n      });\r\n      console.log(item);\r\n      this.publish = item.publish === 1 ? true : false;\r\n    },\r\n    async onSave(item) {\r\n      if (this.editIndex > -1) {\r\n        await BlockService.update(item).then(({ data: { data } }) => {\r\n          Object.assign(this.items[this.editIndex], data);\r\n          this.setBlocks(this.items);\r\n        });\r\n      } else {\r\n        await BlockService.create(item).then(({ data: { data } }) => {\r\n          this.items.unshift(data);\r\n          this.setBlocks(this.items);\r\n        });\r\n      }\r\n      this.openDialog = false;\r\n      this.editIndex = -1;\r\n    },\r\n    getMaxDate() {\r\n      this.newItem = this.items.reduce((a, b) =>\r\n        new Date(a.created_at) > new Date(b.created_at) ? a : b\r\n      );\r\n    },\r\n    async deleteItem(item) {\r\n      const index = await this.items.findIndex(i => i.name == item.name);\r\n      if (index > -1) {\r\n        await BlockService.destroy(item).then(({ data: { message } }) => {\r\n          this.items.splice(index, 1);\r\n          this.sheet.opentSheet = true;\r\n          this.sheet.message = message;\r\n          this.setBlocks(this.items);\r\n        });\r\n      }\r\n    }\r\n  },\r\n  async mounted() {\r\n    await BlockService.index()\r\n      .then(({ data: { data } }) => {\r\n        this.items = data;\r\n        this.isLoading = false;\r\n        this.setBlocks(data);\r\n        console.log(this.blocks);\r\n        if (data.length) this.getMaxDate();\r\n      })\r\n      .catch(err => {\r\n        this.isLoading = true;\r\n        console.log(err);\r\n      });\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scope></style>\r\n","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=7d6f8ba8&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","const NODE_ENV = process.env.NODE_ENV;\r\n\r\nconst dev = {\r\n    DOMAIN_API: \"http://127.0.0.1:8000\"\r\n};\r\n\r\nconst prod = {\r\n    DOMAIN_API: \"https://127.0.0.2\"\r\n};\r\n\r\nexport const config = NODE_ENV == \"development\" ? dev : prod;\r\n","import Axios from \"axios\";\nimport {config} from \"../config.js\";\n\nconst xToken = document.head.querySelector('meta[name=\"x-token\"]');\n\nexport default Axios.create({\n  baseURL: `${config.DOMAIN_API}/api`,\n  headers: {\n    \"Content-type\": \"application/json\",\n    \"Authorization\": `Bearer ${xToken.content}`\n  }\n});\n","export const sleep = (ms) => {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n};\n","import http from \"./../http/http-common\";\r\n\r\nclass BlockService {\r\n  async index() {\r\n    try {\r\n      return await http.get(\"/blocks\");\r\n    } catch ({ response }) {\r\n      if (response.status === 500) _vm.$router.push({name: 'Logout'})\r\n    }\r\n  }\r\n  show(block) { }\r\n  async create(block) {\r\n    return await http.post(\"/blocks\", block);\r\n  }\r\n  async update(block) {\r\n    const data = {\r\n      name: block.name,\r\n      content: block.content,\r\n      updated_at: block.updated_at\r\n    };\r\n    return await http.put(\"/blocks/\" + block.id, data);\r\n  }\r\n  async destroy(block) {\r\n    return await http.delete(`/blocks/${block.id}`);\r\n  }\r\n}\r\n\r\nexport default new BlockService();\r\n"],"sourceRoot":""}